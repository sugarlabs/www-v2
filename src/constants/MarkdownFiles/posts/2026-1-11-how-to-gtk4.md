---
title: "How to GTK4: A Contributor's Guide to Modernizing Sugar"
excerpt: "Why Sugar must move to GTK4, and how contributors can help port activities, the shell, and unlock Wayland"
category: "DEVELOPER NEWS"
date: "2026-01-11"
slug: "2026-1-11-how-to-gtk4"
author: "@/constants/MarkdownFiles/authors/krish-pandya.md"
description: "A practical, step-by-step contributor guide for migrating Sugar Labs from GTK3 to GTK4"
tags: "gtk4,sugarlabs,contributor-guide,porting,wayland"
image: "assets/Images/sugarnews.webp"
---

<!-- markdownlint-disable -->

# How to GTK4


## Why GTK4? Why Now?

If you’re reading this, you’re probably interested in contributing to Sugar and want to understand why the project is moving to GTK4, and where you can help. In open source, stagnation is how projects slowly disappear.

Here's the situation: GTK3, the toolkit Sugar has been built on for years, is approaching end-of-life. Meanwhile, GTK4 brings us:

- Better performance with a modern rendering pipeline
- Wayland support: critical for modern display servers
- Improved accessibility out of the box
- Future-proofing: GTK4 is where GNOME and the Linux desktop ecosystem are headed

But here's the thing: migrating isn't just about updating version numbers. It's about ensuring Sugar can run on today's hardware, today's distros, and continue being relevant for the next generation of learners.


## The Roadmap: Activities → Shell → Wayland

So, where do we start? Trying to port everything at once would be chaos (trust me, I learned this the hard way). Here's a simplified roadmap:

### Phase 1: Port Activities (Start Here!)

This is where **you** come in! Activities are the heart of Sugar, they're what kids actually use to learn, create, and collaborate. Porting activities is the perfect entry point because:

- Low barrier to entry - Activities are smaller, self-contained applications
- Immediate impact - Each ported activity is a win
- Learning opportunity - You'll learn GTK4 patterns without drowning in core system complexity
- Parallel progress - Multiple contributors can work on different activities simultaneously

> **Good news**: The GTK4 toolkit library is already built and on [PyPI](https://pypi.org/project/sugar-toolkit-gtk4/#description)! You can install it with `pip install sugar-toolkit-gtk4` and start porting right away.

### Phase 2: Sugar Shell

Once we have a solid base of GTK4 activities, we tackle the Sugar Shell — the desktop environment itself. This includes:

- The frame (the iconic Sugar border)
- The Journal
- The neighborhood view
- Clipboard and palette systems

The shell depends on the toolkit, so it makes sense to solidify the toolkit and have real-world activity usage feedback before diving into shell porting.

### Phase 3: Wayland Effort

Here's the big one, full Wayland support. Wayland is the modern display server protocol replacing X11. Wayland is not today’s problem, but today’s GTK4 work is what makes it possible later.
Some GTK4 work already helps with Wayland (hello, `Gtk.Popover`!), but full integration requires deep work in the shell and core systems.


## How to Get Started as a New Contributor

So you want to help? Awesome! Here's your path forward, designed to be as smooth as possible:

### Step 1: Set Up Your Environment

First things first, you will need a proper environment to develop and test Sugar activities with GTK4. 

I personally recommend using Nix flakes, install nix on your system and use [the flake](https://github.com/sugarlabs/sugar-toolkit-gtk4/blob/main/flake.nix). So the process would be:

```bash
# Install nix package manager https://nixos.org/download/, no need for NixOS just have nix!
nix develop .
python -m venv .venv
source .venv/bin/activate
cd sugar-toolkit-gtk4
pip install -e .

# Now run some examples from the GTK4 toolkit!
```


This will set you up with everything you need to start porting activities. In case you prefer not to use Nix, ensure you have everything installed manually.

### Step 2: Pick Your First Activity

Not sure where to start? Here's my advice:

- Start simple: Choose an activity with minimal complexity. [Hello World](https://github.com/sugarlabs/hello-world) or similar small activities are perfect first targets.
- Read about Previous Ports: Now we don't have a whole lot of GTK4 Activities, check out the first activity I wrote after porting the toolkit, [Sugar-AI-Activity](https://github.com/MostlyKIGuess/Sugar-AI-Activity), but more importantly check the previous [blog](https://www.sugarlabs.org/news/developer-news/gnome-asia-and-gtk4-port) in which I talk about porting the terminal activity to GTK4.
- Ask in the chat: The Sugar Labs community is friendly, hop into the matrix/IRC channels and ask what needs doing

### Step 3: Learn by Doing

The best way to learn GTK4 porting? Just start porting!

Key changes you'll encounter from GTK3 to GTK4:

- Event controllers replace signals: Instead of connecting to `button-press-event`, use `Gtk.EventController` and `Gtk.Gesture`
- Popovers for menus: No more manual window management - `Gtk.Popover` handles palette-style menus beautifully
- Snapshot instead of draw: Custom rendering uses `snapshot()` function, not `draw()`
- Opaque structures: No more direct access to event fields - use accessor functions/methods.

> **Useful tip**: Keep the [GTK4 Migration Guide](https://docs.gtk.org/gtk4/migrating-3to4.html) bookmarked. It's your best friend.

### Step 4: Test, Test, Test

Sugar is meant to run on real hardware used by real kids. So:

- Test on a Sugar on a Stick (SoaS) installation if you can
- Test it on a Fedora or Ubuntu system with Sugar installed/ or a Virtual Machine
- Try both X11 and Wayland sessions
- Report what you find, even if it doesn't work, that's also valuable feedback, even if it works, let us know that too!

### Step 5: Share Your Work

- Open a pull request: Even if it's not perfect, getting feedback early helps
- Document your journey: Blog posts, commits with good messages — it all helps the next person
- Ask questions: The mentors and community are here to help


## Resources & References

- **GTK4 Toolkit Library** – [sugar-toolkit-gtk4](https://github.com/sugarlabs/sugar-toolkit-gtk4)
- **Documentation** – [Read the Docs](https://sugar-toolkit-gtk4.readthedocs.io/)
- **GTK4 Migration Guide** – [GNOME Docs](https://docs.gtk.org/gtk4/migrating-3to4.html)
- **PyPI Package** – [sugar-toolkit-gtk4](https://pypi.org/project/sugar-toolkit-gtk4/)


## Closing Thoughts

The GTK4 migration is one of those projects that feels daunting at first. Porting an entire desktop ecosystem isn't a weekend hack. But here's the secret: we don't have to do it alone, and we don't have to do it all at once.

Every activity ported is a win. Every bug fixed is progress. Every contributor who joins makes the load lighter.

And honestly, there’s something deeply satisfying about taking a piece of computing history, carefully modernizing it, and knowing it’ll still be usable for the next generation instead of slowly rotting away.

So, if you're an experienced developer looking for a meaningful project, or someone just starting out and wanting to learn, you're most welcome. The toolkit is ready. The activities are waiting.

Pick an activity. Open up your editor. Let's make Sugar modern again.


Until next time, 

Krish (mostlyk)

